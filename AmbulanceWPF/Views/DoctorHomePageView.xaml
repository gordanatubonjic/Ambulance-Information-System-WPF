<Window x:Class="AmbulanceWPF.Views.DoctorHomePageView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:AmbulanceWPF.Views"
        xmlns:helper="clr-namespace:AmbulanceWPF.Helper"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:userControls="clr-namespace:AmbulanceWPF.Views.UserControls"
        mc:Ignorable="d"
        Title="DoctorHomePageView" Height="450" Width="800">
    <Window.Resources>
        <!-- Define the converter -->
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
    </Window.Resources>


    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="78" />
            <RowDefinition Height="115" />
            <RowDefinition/>
        </Grid.RowDefinitions>
        <userControls:AppHeader Grid.Row="0" Margin="0,9,0,9"/>

        <materialDesign:Card Grid.Row="1" Margin="16,16,16,7" >
            <Grid Margin="16">
                <TextBox x:Name="SearchTextBox"
                 materialDesign:HintAssist.Hint="Search patients..."
                 materialDesign:TextFieldAssist.HasLeadingIcon="True"
                 materialDesign:TextFieldAssist.LeadingIcon="Magnify"
                 materialDesign:TextFieldAssist.HasClearButton="True"
                 Style="{StaticResource MaterialDesignOutlinedTextBox}"
                 Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                 FontSize="14"/>
            </Grid>
        </materialDesign:Card>
        <!-- Patient Results -->
        <ScrollViewer Grid.Row="2" VerticalScrollBarVisibility="Auto" Margin="16,8,16,16">
            <ItemsControl ItemsSource="{Binding FilteredPatients}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <materialDesign:Card Margin="0,0,0,12" 
                         materialDesign:RippleAssist.Feedback="{DynamicResource MaterialDesignBody}"
                         Cursor="Hand">
                            <materialDesign:Card.Style>
                                <Style TargetType="materialDesign:Card">
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">

                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </materialDesign:Card.Style>

                            <Grid Margin="16">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- Patient Avatar/Icon -->
                                <materialDesign:PackIcon Grid.Row="0" Grid.Column="0" Grid.RowSpan="2"
                                                       Kind="Account" 
                                                       Width="40" Height="40"
                                                       Foreground="{DynamicResource MaterialDesignBody}"
                                                       VerticalAlignment="Top"
                                                       Margin="0,0,16,0"/>

                                <!-- Patient Name and ID -->
                                <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Horizontal">
                                    <TextBlock Text="{Binding FullName}" 
                                             FontWeight="Medium" 
                                             FontSize="16"
                                             Foreground="{DynamicResource MaterialDesignBody}"/>
                                    <TextBlock Text="{Binding PatientId, StringFormat='(ID: {0})'}" 
                                             FontSize="14"
                                             Foreground="{DynamicResource MaterialDesignBodyLight}"
                                             Margin="8,0,0,0"/>
                                </StackPanel>

                                <!-- Age and Gender -->
                                <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Margin="0,4,0,8">
                                    <materialDesign:PackIcon Kind="Calendar" Width="16" Height="16" 
                                                           Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                           VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding Age}" 
                                             FontSize="12"
                                             Foreground="{DynamicResource MaterialDesignBodyLight}"
                                             Margin="4,0,16,0"/>

                                    <materialDesign:PackIcon Kind="Human" Width="16" Height="16" 
                                                           Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                           VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding Gender}" 
                                             FontSize="12"
                                             Foreground="{DynamicResource MaterialDesignBodyLight}"
                                             Margin="4,0,0,0"/>
                                </StackPanel>

                                <!-- Contact Info -->
                                <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal" Margin="0,0,0,8">
                                    <materialDesign:PackIcon Kind="Phone" Width="16" Height="16" 
                                                           Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                           VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding PhoneNumber}" 
                                             FontSize="12"
                                             Foreground="{DynamicResource MaterialDesignBodyLight}"
                                             Margin="4,0,16,0"/>

                                    <materialDesign:PackIcon Kind="MapMarker" Width="16" Height="16" 
                                                           Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                           VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding Address}" 
                                             FontSize="12"
                                             Foreground="{DynamicResource MaterialDesignBodyLight}"
                                             Margin="4,0,0,0"
                                             TextTrimming="CharacterEllipsis"/>
                                </StackPanel>

                                <!-- Medical Info -->
                                <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="MedicalBag" Width="16" Height="16" 
                                                           Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                           VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding LastVisit, StringFormat='Last visit: {0:MMM dd, yyyy}'}" 
                                             FontSize="12"
                                             Foreground="{DynamicResource MaterialDesignBodyLight}"
                                             Margin="4,0,16,0"/>

                                    <materialDesign:Chip Content="{Binding Priority}" 
                                                       FontSize="10"
                                                       Margin="0"
                                                       Height="20">
                                        <materialDesign:Chip.Style>
                                            <Style TargetType="materialDesign:Chip" BasedOn="{StaticResource {x:Type materialDesign:Chip}}">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Priority}" Value="High">
                                                        <Setter Property="Background" Value="#FFEBEE"/>
                                                        <Setter Property="Foreground" Value="#C62828"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Priority}" Value="Medium">
                                                        <Setter Property="Background" Value="#FFF3E0"/>
                                                        <Setter Property="Foreground" Value="#F57C00"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Priority}" Value="Low">
                                                        <Setter Property="Background" Value="#E8F5E8"/>
                                                        <Setter Property="Foreground" Value="#2E7D32"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </materialDesign:Chip.Style>
                                    </materialDesign:Chip>
                                </StackPanel>

                                <!-- Action Button -->
                                <Button Grid.Row="0" Grid.Column="2" Grid.RowSpan="4"
                                      Style="{StaticResource MaterialDesignIconButton}"
                                      Command="{Binding DataContext.ViewPatientCommand, RelativeSource={RelativeSource AncestorType=UserControl}}"
                                      CommandParameter="{Binding}"
                                      VerticalAlignment="Center">
                                    <materialDesign:PackIcon Kind="ChevronRight" Width="24" Height="24"/>
                                </Button>
                            </Grid>
                        </materialDesign:Card>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
        <!-- Empty State -->
        <StackPanel Grid.Row="2" 
           VerticalAlignment="Top" 
           HorizontalAlignment="Center"
           Visibility="{Binding IsEmptyStateVisible, Converter={StaticResource BooleanToVisibilityConverter}}" Margin="0,53,0,0" Height="121" Width="164">
            <materialDesign:PackIcon Kind="AccountSearch" 
                           Width="64" Height="64"
                           Foreground="{DynamicResource MaterialDesignBodyLight}"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,16"/>
            <TextBlock Text="No patients found" 
             FontSize="16"
             Foreground="{DynamicResource MaterialDesignBodyLight}"
             HorizontalAlignment="Center"/>
            <TextBlock Text="Try adjusting your search terms" 
             FontSize="12"
             Foreground="{DynamicResource MaterialDesignBodyLight}"
             HorizontalAlignment="Center"
             Margin="0,4,0,0"/>
        </StackPanel>
    </Grid>

</Window>
