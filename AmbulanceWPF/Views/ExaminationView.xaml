<Window x:Class="AmbulanceWPF.Views.ExaminationView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:viewmodels="clr-namespace:AmbulanceWPF.ViewModels" 
        Title="Examination View" Height="750
        " Width="1000"
        WindowStartupLocation="CenterOwner">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="24">

            <!-- Header -->
            <Border Background="{DynamicResource PrimaryHueDarkBrush}" CornerRadius="8" Margin="0,0,0,24" Padding="16">
                <StackPanel Orientation="Horizontal">
                    <materialDesign:PackIcon Kind="Stethoscope" Foreground="White" Width="32" Height="32" Margin="0,0,12,0"/>
                    <TextBlock Text="PATIENT EXAMINATION FORM" Foreground="White" FontSize="20" FontWeight="Bold"/>
                </StackPanel>
            </Border>

            <!-- Patient Info -->
            <materialDesign:Card Margin="0,0,0,20" Padding="16">
                <StackPanel>
                    <TextBlock Text="Patient Information" Style="{StaticResource MaterialDesignHeadline6TextBlock}" Margin="0,0,0,12"/>
                    <TextBox Text="{Binding Patient.FullName, Mode=OneWay}" IsReadOnly="True" materialDesign:HintAssist.Hint="Patient Name" Style="{StaticResource MaterialDesignFloatingHintTextBox}"/>
                    <TextBox Text="{Binding Patient.JMB, Mode=OneWay}" IsReadOnly="True" materialDesign:HintAssist.Hint="JMB" Style="{StaticResource MaterialDesignFloatingHintTextBox}" Margin="0,12,0,0"/>
                </StackPanel>
            </materialDesign:Card>

            <!-- Examination Details -->
            <materialDesign:Card Margin="0,0,0,20" Padding="16">
                <StackPanel>
                    <TextBlock Text="Examination Details" Style="{StaticResource MaterialDesignHeadline6TextBlock}" Margin="0,0,0,12"/>
                    <DatePicker SelectedDate="{Binding Examination.ExaminationDate}" materialDesign:HintAssist.Hint="Examination Date" Style="{StaticResource MaterialDesignFloatingHintDatePicker}"/>
                    <TextBox Text="{Binding Examination.ExaminationDescription, UpdateSourceTrigger=PropertyChanged}" materialDesign:HintAssist.Hint="Description" Style="{StaticResource MaterialDesignFloatingHintTextBox}" AcceptsReturn="True" Height="100" VerticalScrollBarVisibility="Auto" Margin="0,12,0,0"/>
                </StackPanel>
            </materialDesign:Card>

            <!-- Diagnosis -->
            <materialDesign:Card Margin="0,0,0,20" Padding="16">
                <StackPanel>
                    <TextBlock Text="Diagnosis" Style="{StaticResource MaterialDesignHeadline6TextBlock}" Margin="0,0,0,12"/>
                    <DataGrid ItemsSource="{Binding Diagnosis}" AutoGenerateColumns="False" CanUserAddRows="False" Height="150" Margin="0,0,0,12">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Disease" Binding="{Binding Disease.DiseaseName}" Width="*"/>
                            <DataGridTextColumn Header="Opinion" Binding="{Binding DoctorOpinion}" Width="*"/>
                            <DataGridTextColumn Header="Date" Binding="{Binding Date}" Width="*"/>
                            <DataGridTemplateColumn Width="Auto">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="Remove" Command="{Binding DataContext.RemoveDiagnosisCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" Style="{StaticResource MaterialDesignFlatButton}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                    <Button Content="Add Diagnosis" Command="{Binding AddDiagnosisCommand}" HorizontalAlignment="Right"/>
                </StackPanel>
            </materialDesign:Card>

            <!-- Referrals -->
            <materialDesign:Card Margin="0,0,0,20" Padding="16">
                <StackPanel>
                    <TextBlock Text="Referrals" Style="{StaticResource MaterialDesignHeadline6TextBlock}" Margin="0,0,0,12"/>
                    <DataGrid ItemsSource="{Binding Referrals}" AutoGenerateColumns="False" CanUserAddRows="False" Height="150" Margin="0,0,0,12">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Disease" Binding="{Binding Disease.DiseaseName}" Width="*"/>
                            <DataGridTextColumn Header="Specialists" Binding="{Binding Specialists}" Width="*"/>
                            <DataGridTextColumn Header="Date" Binding="{Binding Date}" Width="*"/>
                            <DataGridTemplateColumn Width="Auto">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="Remove" Command="{Binding DataContext.RemoveReferralCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" Style="{StaticResource MaterialDesignFlatButton}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                    <Button Content="Add Referral" Command="{Binding AddReferralCommand}" HorizontalAlignment="Right"/>
                </StackPanel>
            </materialDesign:Card>

            <!-- Procurement (Medications) -->
            <materialDesign:Card Margin="0,0,0,20" Padding="16">
                <StackPanel>
                    <TextBlock Text="Procurement (Medications)" Style="{StaticResource MaterialDesignHeadline6TextBlock}" Margin="0,0,0,12"/>
                    <DataGrid ItemsSource="{Binding Procurements}" AutoGenerateColumns="False" CanUserAddRows="False" Height="150" Margin="0,0,0,12">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Quantity" Binding="{Binding Quantity}" Width="*"/>
                            <DataGridTextColumn Header="Date" Binding="{Binding ProcurementDate}" Width="*"/>
                            <DataGridTemplateColumn Width="Auto">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="Remove" Command="{Binding DataContext.RemoveProcurementCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" Style="{StaticResource MaterialDesignFlatButton}"/>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                    </DataGrid>
                    <Button Content="Add Procurement" Command="{Binding AddProcurementCommand}" HorizontalAlignment="Right"/>
                </StackPanel>
            </materialDesign:Card>

            <!-- Action Buttons -->
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,20,0,0">
                <Button Content="Save Examination" Command="{Binding SaveCommand}" Width="160" Height="50" FontSize="16" FontWeight="Bold"/>
                <Button Content="Cancel" Command="{Binding CancelCommand}" Margin="12,0,0,0" Style="{StaticResource MaterialDesignFlatButton}" Width="120"/>
            </StackPanel>

        </StackPanel>
    </ScrollViewer>
</Window>